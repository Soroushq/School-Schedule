# بهبود مدیریت دسترسی به localStorage

## تغییرات انجام شده

در این بروزرسانی، موارد زیر اضافه و اصلاح شده است:

### 1. افزودن مودال توافق‌نامه کاربر
- کامپوننت جدید `UserAgreementModal` برای نمایش توافق‌نامه کامل به کاربران در اولین بازدید
- توضیحات کامل درباره نحوه استفاده از داده‌ها و دسترسی به حافظه محلی مرورگر
- نیاز به پذیرش توافق‌نامه قبل از استفاده از برنامه
- هدایت کاربر به صفحه `access-denied` در صورت عدم پذیرش

### 2. اضافه کردن سرویس مدیریت حافظه محلی
- ایجاد کلاس `StorageService` برای مدیریت امن دسترسی به localStorage
- مکانیزم بررسی دسترسی قبل از هر عملیات ذخیره/بازیابی
- هندلینگ خطاها و مدیریت وضعیت‌های مختلف دسترسی
- استفاده از الگوی Singleton برای استفاده یکپارچه در کل برنامه

### 3. بروزرسانی سرویس‌های موجود
- بروزرسانی `syncService` و `scheduleSync` برای استفاده از سرویس جدید به جای دسترسی مستقیم به localStorage
- مدیریت بهتر خطاها و توقف عملیات در صورت عدم دسترسی
- بهبود ساختار کد و الگوهای استفاده از localStorage

### 4. اضافه کردن نشانگر وضعیت دسترسی
- کامپوننت `StorageAccessIndicator` برای نمایش هشدار در صورت مشکل در دسترسی به localStorage
- توضیحات به زبان فارسی و راهنمایی کاربر برای رفع مشکل
- امکان بررسی مجدد دسترسی و بارگذاری مجدد صفحه

### 5. راهنمای کامل تنظیمات مرورگر
- کامپوننت `BrowserPermissionHelp` با راهنمای گام به گام برای فعال‌سازی دسترسی در مرورگرهای مختلف
- تب‌های مجزا برای مرورگرهای محبوب (کروم، فایرفاکس، اج، سافاری)
- راه‌حل‌های عمومی برای رفع مشکلات مربوط به دسترسی

## راهنمای استفاده برای کاربران

### مشکلات رایج و راه‌حل‌ها

1. **مرورگر اجازه دسترسی به حافظه محلی را نمی‌دهد**
   - در کروم: به `chrome://settings/cookies` بروید و وب‌سایت ما را به لیست استثناها اضافه کنید
   - در فایرفاکس: به تنظیمات > حریم خصوصی و امنیت > داده‌های سایت > استثناها بروید
   - در اج: از طریق تنظیمات > حریم خصوصی > کوکی‌ها > استثناها اقدام کنید
   - مطمئن شوید گزینه "مسدود کردن کوکی‌های شخص ثالث" فعال نیست

2. **گزینه "Don't allow" را در پاپ‌آپ مرورگر انتخاب کرده‌اید**
   - کوکی‌های مرورگر را پاک کنید
   - به تنظیمات مرورگر بروید و سایت را به لیست مجاز اضافه کنید
   - مرورگر را به طور کامل بسته و دوباره باز کنید

3. **از حالت ناشناس (Incognito) استفاده می‌کنید**
   - برنامه در حالت ناشناس به درستی کار نمی‌کند
   - لطفاً از حالت عادی مرورگر استفاده کنید

4. **از مسدودکننده‌های تبلیغات یا افزونه‌های حریم خصوصی استفاده می‌کنید**
   - این افزونه‌ها ممکن است دسترسی به localStorage را مسدود کنند
   - موقتاً آن‌ها را غیرفعال کنید یا سایت ما را به لیست سفید آن‌ها اضافه کنید

## اطلاعات فنی برای توسعه‌دهندگان

- تمام دسترسی‌های مستقیم به `localStorage` باید از طریق `storageService` انجام شود
- برای بررسی وضعیت دسترسی از متد `storageService.getAccessStatus()` استفاده کنید
- قبل از هر عملیات خواندن/نوشتن، کنترل کنید که دسترسی موجود باشد
- در صورت خطا، از مکانیزم‌های خطایابی و گزارش خطای موجود استفاده کنید 